%h1
  Summary for #{@campaign.name}

- if @campaign.is_sem?
  .section#first-section
    .left#timeline_chart
      %h3 Campaign Performance
      = render :partial => "shared/timeline"
    .right
      = render :partial => "shared/gauge"
  .clear
-else
  .section#first-section
    .left#timeline_chart
      %h3 Campaign Performance
      = render :partial => "shared/timeline"
    .right
      = render :partial => "shared/news_results"
  .clear     

%h3
  Last Week
%table{:class => "pretty"}
  %thead
    %tr
      %th
        Calls
      %th
        Forms
      %th
        Total Leads
      %th
        Spend
      %th
        Cost Per Lead
  %tbody
    %tr
      %td
        = @campaign.number_of_all_calls_between(Date.today - 1.week, Date.today).to_s
      %td
        = @campaign.number_of_submissions_between(Date.today - 1.week, Date.today).to_s
      %td
        = @campaign.number_of_total_leads_between(Date.today - 1.week, Date.today).to_s
      %td
        = ActionController::Base.helpers.number_to_currency(@campaign.spend_between(Date.today - 1.week, Date.today))
      %td
        = ActionController::Base.helpers.number_to_currency(@campaign.cost_per_lead_between(Date.today - 1.week, Date.today))
%h3
  Call Log
%table{:class => "pretty"}
  %thead
    %tr
      %th
        Caller
      %th
        Caller #
      %th
        Inbound #
      %th
        Time of Call
      %th
        Duration
      %th
        Result
      %th
        Disposition
      %th
        Rating
      %th
        Revenue
  %tbody
    -@campaign.calls.find(:all, :conditions => ['call_start between ? AND ?', Date.today - 1.week, Date.today]).each do |call|
      %tr{ :class => cycle('odd', 'even')}
        %td
          = call.caller_name
        %td
          = call.caller_number
        %td
          = call.inboundno
        %td
          = call.call_start.to_s
        %td
          = call.duration
        %td
          = call.call_status
        %td
          = call.disposition
        %td
          = call.rating
        %td
          = call.revenue



