- if @activity.is_call? && @activity.activity_type.recorded? && @activity.activity_type.recording?
  :javascript
    $(document).ready(function(){
      $("#player").flash({
        src: 'http://#{APP_CONFIG[:host]}/player.swf',
        width: '150px',
        height: '22px',
        flashvars: { file: '#{@activity.activity_type.recording.expiring_url}'}
      });
    });

:javascript
  $(document).ready(function(){
    function flash_message(str, class) {
      $('#activity_message').hide();
      $('#activity_message').empty();
      $('#activity_message').html(str);
      $('#activity_message').addClass(class);
      $('#activity_message').show('blind', 400, function() {
        $('#activity_message').delay(1000).hide('blind', 400);
      });
    }
    function save_form() {
      // grab drop down information
      var review_status = $('#activity_review_status').val();
      // Grab the url from the form
      var form_url = $('form[id*="activity"]').first().attr('action');
      $.ajax({
        type: 'POST',
        url: form_url,
        data: $('form[id*="activity"]').serialize(),
        success: function() {
          flash_message('Saved!', 'flash_notice');
        },
        error: function() {
          flash_message('Error!', 'flash_error');
        }
      });
    }
    $("#activity_review_status").change(function() {
      save_form();
    });
    $("#save_form").click(function(){
      save_form();
    })

  });

- if @activity.is_call?
  %h3.strong=@activity.activity_type.phone_number.campaign.account.name
  %h4.quiet=@activity.activity_type.phone_number.campaign.name
  .notice
    %h4.strong Review
    %p
      %span.strong=@activity.activity_type.caller_name
      %br
      =number_to_phone(@activity.activity_type.caller_number)
      %br
      -if @activity.activity_type.recorded? && @activity.activity_type.recording?
        %center
          %div#player
    %p
      -activity_time_zone = @activity.activity_type.phone_number.campaign.account.time_zone
      =time_ago_in_words(@activity.activity_type.call_start) + " ago"
      %br
      %span{:class => @activity.activity_type.call_status.downcase}
      =(@activity.activity_type.call_end - @activity.activity_type.call_start).to_int
      seconds
      - form_for @activity do |f|
        %p
          %label Status:
          %br
          = f.select(:review_status, (@activity.activity_type.review_status_options))
        %p
          %label Notes:
          %br
          %textarea{ :name => "activity[description]", :id => "description"}
            =@activity.description
      %p
        %center
          %button{:id => "save_form", :class => "button"} Save
          %div{:id => 'activity_message'}

- elsif @activity.is_submission?
  %h3.strong=@activity.activity_type.contact_form.campaign.account.name
  %h4.quiet=@activity.activity_type.contact_form.campaign.name
  .notice
    %h4.strong Review
    %p
      %span.strong=@activity.activity_type.name
    %p
      -activity_time_zone = @activity.activity_type.contact_form.campaign.account.time_zone
      =time_ago_in_words(@activity.timestamp) + " ago"
      %br
      - form_for @activity do |f|
        %p
          %label Status:
          %br
          = f.select(:review_status, (@activity.activity_type.review_status_options))
        %p
          %label Notes:
          %br
          %textarea{ :name => "activity[description]", :id => "description" }
            =@activity.description
      %p
        %center
          %button{:id => "save_form", :class => "button"} Save
          %div{:id => 'activity_message'}

